<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Profile - CV Builder</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/build/jwt-decode.min.js"></script>

    <link rel="stylesheet" href="cv-profile-system.css">
</head>
<body>
    <header>
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <h1>Professional Profile</h1>
            <button class="btn btn-danger" onclick="logout()" title="Logout">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </header>
    
    <div class="container">
        <!-- Section 1 / 6 : PROFILE -->
        <div class="profile-header">
            <div class="profile-image">
                <img id="profilePic" alt="Profile Picture" onerror="this.onerror=null;this.src='default-profile.png';" title="Profile Picture">
                <input type="file" id="profilePicInput" accept="image/*" style="margin-top:10px;" title="Upload your profile picture">
                <button class="btn btn-info" id="uploadPicBtn" style="margin-top:5px;" title="Upload Picture">Upload Picture</button>
            </div>
            <div class="profile-info">
                <h2 id="userName">Loading...</h2>
                <p id="userEmail"><i class="fas fa-envelope"></i> Loading...</p>
                <p id="userPhone"><i class="fas fa-phone"></i> Loading...</p>
                <p id="userAddress"><i class="fas fa-map-marker-alt"></i> Loading...</p>
                <div class="social-links">
                    <a href="#" id="linkedinLink" target="_blank" title="LinkedIn Profile"><i class="fab fa-linkedin"></i></a>
                    <a href="#" id="githubLink" target="_blank" title="GitHub Profile"><i class="fab fa-github"></i></a>
                    <a href="#" id="portfolioLink" target="_blank" title="Portfolio Website"><i class="fas fa-globe"></i></a>
                </div>
                <button class="btn btn-warning" id="edit-profile-btn" onclick= openEditProfileModal() title="Edit Profile">
                    <i class="fas fa-user-edit"></i> Edit Profile
                </button>
                <div class="profile-actions">
                    <button class="btn btn-primary" id="generatePdfBtn" title="Generate PDF" onclick="generatePDF()">
                        <i class="fas fa-file-pdf"></i> Generate PDF
                    </button>
                    <button class="btn btn-secondary" id="emailCvBtn" title="Email CV" onclick="sendEmail()">
                        <i class="fas fa-envelope"></i> Email CV
                    </button>
                </div>
            </div>
        </div>
                <!-- Edit Profile Modal -->
                <div id="editProfileModal" class="modal">
                    <div class="modal-content">
                        <span class="close" onclick="closeEditProfileModal()">&times;</span>
                        <h2>Edit Profile</h2>
                        <form id="editProfileForm" >
                            <label for="editName">Name:</label>
                            <input type="text" id="editName" required><br><br>
                            <label for="editEmail">Email:</label>
                            <input type="email" id="editEmail" required><br><br>
                            <label for="editPhone">Phone:</label>
                            <input type="text" id="editPhone"><br><br>
                            <label for="editAddress">Address:</label>
                            <input type="text" id="editAddress"><br><br>
                            <label for="editBio">Bio:</label>
                            <textarea id="editBio"></textarea><br><br>
                            <label for="editLinkedinUrl">LinkedIn URL:</label>
                            <input type="url" id="editLinkedinUrl"><br><br>
                            <label for="editGithubUrl">GitHub URL:</label>
                            <input type="url" id="editGithubUrl"><br><br>
                            <label for="editPortfolioUrl">Portfolio URL:</label>
                            <input type="url" id="editPortfolioUrl"><br><br>
                            <button type="button" class="btn btn-primary" onclick="saveProfileChanges(event)">Save Changes</button>                        </form>
                    </div>
                </div>

        <div class="section" id="bioSection">
            <div class="section-title">
                <i class="fas fa-user"></i>
                <h3>About Me</h3>
            </div>
            <div id="userBio">
                <div class="empty-state">
                    <i class="fas fa-user-edit"></i>
                    <p>No bio information available</p>
                </div>
            </div>
        </div>
        
        <!-- Section 2 / 6 : EDUCATION -->
        <!-- Education Section -->
        <div class="section" id="educationSection">
            <div class="section-title" style="display: flex; align-items: center;">
                <i class="fas fa-graduation-cap"></i>
                <h3 style="margin-right: auto;">Education</h3>
                <button class="btn btn-success" onclick="openCreateEducationModal()">Add Education</button>
            </div>
            <div id="educationContainer">
                <div class="empty-state">
                    <i class="fas fa-graduation-cap"></i>
                    <p>No education details added yet</p>
                </div>
            </div>
        </div>
        
        <!-- Create Education Modal -->
        <div id="createEducationModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeCreateEducationModal()">&times;</span>
                <h2>Add Education</h2>
                <form id="createEducationForm">
                    <label for="degree">Degree:</label>
                    <input type="text" id="degree" required><br><br>
                    <label for="fieldOfStudy">Field of Study:</label>
                    <input type="text" id="fieldOfStudy" required><br><br>
                    <label for="institution">Institution:</label>
                    <input type="text" id="institution" required><br><br>
                    <label for="startYear">Start Year:</label>
                    <input type="number" id="startYear" required><br><br>
                    <label for="endYear">End Year:</label>
                    <input type="number" id="endYear"><br><br>
                    <label for="educationDescription">Description:</label>
                    <textarea id="educationDescription"></textarea><br><br>
                    <button type="button" class="btn btn-primary" onclick="saveNewEducation()">Save</button>
                </form>
            </div>
        </div>
        
        <!-- Edit Education Modal -->
        <div id="editEducationModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeEditEducationModal()">&times;</span>
                <h2>Edit Education</h2>
                <form id="editEducationForm">
                    <input type="hidden" id="educationId">
                    <label for="editDegree">Degree:</label>
                    <input type="text" id="editDegree" required><br><br>
                    <label for="editFieldOfStudy">Field of Study:</label>
                    <input type="text" id="editFieldOfStudy" required><br><br>
                    <label for="editInstitution">Institution:</label>
                    <input type="text" id="editInstitution" required><br><br>
                    <label for="editStartYear">Start Year:</label>
                    <input type="number" id="editStartYear" required><br><br>
                    <label for="editEndYear">End Year:</label>
                    <input type="number" id="editEndYear"><br><br>
                    <label for="editEducationDescription">Description:</label>
                    <textarea id="editEducationDescription"></textarea><br><br>
                    <button type="button" class="btn btn-primary" onclick="saveEditedEducation()">Save Changes</button>
                </form>
            </div>
        </div>
        
        <div class="section" id="experienceSection">
            <div class="section-title" style="display: flex; align-items: center;">
                <i class="fas fa-briefcase"></i>
                <h3 style="margin-right: auto;">Work Experience</h3>
                <button class="btn btn-success" id="addExperienceBtn">
                    <i class="fas fa-plus"></i> Add Experience
                </button>
            </div>
            <div id="experienceContainer">
                <div class="empty-state">
                    <i class="fas fa-briefcase"></i>
                    <p>No work experience added yet</p>
                </div>
            </div>
        </div>
            <!-- Experience Modal (for Add/Edit) --
    <div id="experienceModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeExperienceModal()">&times;</span>
            <h2 id="experienceModalTitle">Edit Experience</h2>
            <form id="experienceForm">
                <input type="hidden" id="experienceId">
                <label>Job Title: <input type="text" id="experienceJobTitle" required></label><br><br>
                <label>Company: <input type="text" id="experienceCompany" required></label><br><br>
                <label>Start Date: <input type="month" id="experienceStartDate" required></label><br><br>
                <label>End Date: <input type="month" id="experienceEndDate"></label><br><br>
                <label>Description: <textarea id="experienceDescription"></textarea></label><br><br>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div> -->
        <div class="section" id="projectsSection">
            <div class="section-title">
                <i class="fas fa-project-diagram"></i>
                <h3>Projects</h3>
            </div>
            <div id="projectsContainer">
                <div class="empty-state">
                    <i class="fas fa-project-diagram"></i>
                    <p>No projects added yet</p>
                </div>
            </div>
        </div>
        
        <div class="section" id="certificationsSection">
            <div class="section-title">
                <i class="fas fa-certificate"></i>
                <h3>Certifications</h3>
            </div>
            <div id="certificationsContainer">
                <div class="empty-state">
                    <i class="fas fa-certificate"></i>
                    <p>No certifications added yet</p>
                </div>
            </div>
        </div>
            
        <div class="section" id="skillsSection">
            <div class="section-title">
                <i class="fas fa-tools"></i>
                <h3>Skills</h3>
            </div>
            <div id="skillsContainer">
                <div class="empty-state">
                    <i class="fas fa-tools"></i>
                    <p>No skills added yet</p>
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 CV Builder. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- PDF Modal -->
    <div id="pdfModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePdfModal()">&times;</span>
            <h2>CV Preview</h2>
            <div class="profile-actions" style="margin-bottom: 20px;">
                <button class="btn btn-primary" onclick="downloadPDF()">
                    <i class="fas fa-download"></i> Download PDF
                </button>
                <button class="btn btn-secondary" onclick="sendEmail()">
                    <i class="fas fa-envelope"></i> Email CV
                </button>
            </div>
            <div id="pdfPreview"></div>
        </div>
    </div>
 
    <!-- Hidden PDF template for export -->
    <div id="pdfTemplate" class="pdf-container">
        <div class="pdf-header">
            <h1 id="pdf-name">Full Name</h1>
            <div class="pdf-contact">
                <span id="pdf-email">email@example.com</span> | 
                <span id="pdf-phone">Phone Number</span> | 
                <span id="pdf-address">Address</span>
            </div>
            <div class="pdf-contact" id="pdf-links"></div>
        </div>
        
        <div class="pdf-section" id="pdf-bio-section">
            <h2>Professional Summary</h2>
            <div id="pdf-bio"></div>
        </div>
        
        <div class="pdf-section" id="pdf-education-section">
            <h2>Education</h2>
            <div id="pdf-education"></div>
        </div>
        
        <div class="pdf-section" id="pdf-experience-section">
            <h2>Work Experience</h2>
            <div id="pdf-experience"></div>
        </div>

        <div class="pdf-section" id="pdf-projects-section">
            <h2>Projects</h2>
            <div id="pdf-projects"></div>
        </div>
    
        <div class="pdf-section" id="pdf-certifications-section">
            <h2>Certifications</h2>
            <div id="pdf-certifications"></div>
        </div>
        
        <div class="pdf-section" id="pdf-skills-section">
            <h2>Skills</h2>
            <div id="pdf-skills"></div>
        </div>
    </div>

    <script src="cv-profile-system.js"></script>
    <script src="pdf-email.js"></script>


</body>
</html>